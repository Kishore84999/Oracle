Business Unit
=================
select haotl.NAME BUSINESS_UNIT
,(select meaning from fnd_lookup_values where lookup_type='ACTIVE_INACTIVE' and lookup_code=hac.status) as Status
,hao.EFFECTIVE_START_DATE AS "EFFECTIVE_START_DATE"
,decode(to_char(hao.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,hao.EFFECTIVE_END_DATE) AS "EFFECTIVE_END_DATE"
FROM
HR_ORG_UNIT_CLASSIFICATIONS_F hac,
HR_ALL_ORGANIZATION_UNITS_F hao,
HR_ORGANIZATION_UNITS_F_TL haotl
WHERE 1=1
AND hao.ORGANIZATION_ID = hac.ORGANIZATION_ID 
AND hao.ORGANIZATION_ID = haotl.ORGANIZATION_ID 
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,hac.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,hac.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,hao.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,hao.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,haotl.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,haotl.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY')) 
AND haotl.EFFECTIVE_START_DATE = hao.EFFECTIVE_START_DATE
AND haotl.EFFECTIVE_END_DATE = hao.EFFECTIVE_END_DATE 
AND hac.CLASSIFICATION_CODE = 'FUN_BUSINESS_UNIT'

DEPARTMENT
=============

SELECT
		hao.EFFECTIVE_START_DATE
		,decode(to_char(hao.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,hao.EFFECTIVE_END_DATE) AS "EFFECTIVE_END_DATE"
		,haotl.NAME ORGANIZATION_NAME
		,hac.STATUS
		,hac.CLASSIFICATION_CODE "ORGANIZATION_TYPE"
		,HAO.ATTRIBUTE1 "GL_DIVISION"
		,HAO.ATTRIBUTE2 "GL_DEPARTMENT"
		,HAO.ATTRIBUTE3 "GL_PRODUCT_LINE"
		,HAO.ATTRIBUTE4 "GL_SITE"
		,HAO.ATTRIBUTE5 "ORG_L1"
		,HAO.ATTRIBUTE6 "ORG_L2"
		,HAO.ATTRIBUTE7 "ORG_L3"
		,HAO.ATTRIBUTE8 "Func"
		,HAO.ATTRIBUTE9 "SUB_FUNCTION"
		,HAO.ATTRIBUTE15 "ESTAFF"
		,HAO.ATTRIBUTE14 "Sr_HRBP"
		, HAO.ATTRIBUTE16 "HRBP"	
		, HAO.ATTRIBUTE11 "HR_Organization"
		,HAO.ATTRIBUTE12 "Project_Expenditure"
		,HAO.ATTRIBUTE13 "Project_Task"
		,HAO.ATTRIBUTE10 "SET_OF_BOOKS"
		,hao.CREATION_DATE
		,hao.LAST_UPDATE_DATE	
FROM
HR_ORG_UNIT_CLASSIFICATIONS_F hac,
HR_ALL_ORGANIZATION_UNITS_F hao,
HR_ORGANIZATION_UNITS_F_TL haotl
WHERE 1=1
AND hao.ORGANIZATION_ID = hac.ORGANIZATION_ID 
AND hao.ORGANIZATION_ID = haotl.ORGANIZATION_ID 
AND sysdate  BETWEEN hac.EFFECTIVE_START_DATE AND NVL(hac.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND sysdate  BETWEEN hao.EFFECTIVE_START_DATE AND NVL(hao.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND sysdate  BETWEEN haotl.EFFECTIVE_START_DATE AND NVL(haotl.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND haotl.EFFECTIVE_START_DATE = hao.EFFECTIVE_START_DATE 
AND haotl.EFFECTIVE_END_DATE = hao.EFFECTIVE_END_DATE 
AND hac.CLASSIFICATION_CODE = 'DEPARTMENT'

Enterprise
=======================
SELECT HAOTL.NAME
      ,HE.SHORT_NAME
      ,HE.PRIMARY_INDUSTRY PRIMARY_INDUS
      ,'' HCOUNTRY
      ,'' COUNTRY
      ,'' ADDRESS
      ,HAOTL.EFFECTIVE_START_DATE EFFECTIVE_START_DATE
FROM
HR_ORG_UNIT_CLASSIFICATIONS_F hac,
HR_ALL_ORGANIZATION_UNITS_F hao,
HR_ORGANIZATION_UNITS_F_TL haotl,
HRW_ENTERPRISES HE 
WHERE hao.ORGANIZATION_ID = hac.ORGANIZATION_ID 
AND hao.ORGANIZATION_ID = haotl.ORGANIZATION_ID 
AND hao.EFFECTIVE_START_DATE BETWEEN hac.EFFECTIVE_START_DATE AND hac.EFFECTIVE_END_DATE 
--AND SYSDATE BETWEEN HAOTL.EFFECTIVE_START_DATE AND HAOTL.EFFECTIVE_END_DATE 
AND haotl.LANGUAGE = USERENV('LANG') 
AND haotl.EFFECTIVE_START_DATE = hao.EFFECTIVE_START_DATE 
AND haotl.EFFECTIVE_END_DATE = hao.EFFECTIVE_END_DATE 
AND hac.CLASSIFICATION_CODE = 'ENTERPRISE'
and haotl.ORGANIZATION_ID = HE.ENTERPRISE_ID(+)

Grade
=========
SELECT
 PG.EFFECTIVE_START_DATE
,decode(to_char(PG.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,PG.EFFECTIVE_END_DATE) AS EFFECTIVE_END_DATE
--,NULL COUNTRY   ---PRFV.LEGISLATION_CODE
,( select meaning FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='JEES_EURO_COUNTRY_CODES' and LOOKUP_CODE = PRFV.LEGISLATION_CODE and LANGUAGE = 'US') as "COUNTRY"
,PG.GRADE_CODE 
,PG.NAME AS GRADE_NAME
,PRFV.RATE_FREQUENCY AS "GRADE_FREQUENCY"
,PRFV.RATE_TYPE GRADE_RATE_TYPE
,PRFV.CURRENCY_CODE CURRENCY
,PRVF.MINIMUM
,PRVF.MID_VALUE MIDPOINT
,PRVF.MAXIMUM
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='ACTIVE_INACTIVE' AND LOOKUP_CODE=PG.ACTIVE_STATUS and LANGUAGE = 'US') AS STATUS
,PRFV.NAME "SALARY_BASIS"
FROM
 PER_GRADES PG
,PER_RATES_F_VL PRFV
,PER_RATE_VALUES_F PRVF
WHERE 1=1
AND  PG.GRADE_ID = PRVF.RATE_OBJECT_ID(+)
AND PRVF.RATE_ID = PRFV.RATE_ID(+)  
AND PRVF.RATE_OBJECT_TYPE(+)  ='GRADE' 
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PG.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PG.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PRFV.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PRFV.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PRVF.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PRVF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
--and PG.GRADE_CODE = 'N10'
ORDER BY PG.NAME

Job Family
==========
select 
PJFFT.EFFECTIVE_START_DATE
,PJFFT.JOB_FAMILY_NAME
, NULL ACTION_REASON
,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='ACTIVE_INACTIVE' 
						AND LOOKUP_CODE=PJFF.ACTIVE_STATUS
						AND SYSDATE between START_DATE_ACTIVE and END_DATE_ACTIVE ) AS ACTIVE_STATUS
from PER_JOB_FAMILY_F_TL PJFFT,
PER_JOB_FAMILY_F PJFF
WHERE PJFFT.JOB_FAMILY_ID = PJFF.JOB_FAMILY_ID(+)
AND SYSDATE BETWEEN PJFFT.EFFECTIVE_START_DATE AND PJFFT.EFFECTIVE_END_DATE
AND SYSDATE BETWEEN PJFF.EFFECTIVE_START_DATE AND PJFF.EFFECTIVE_END_DATE
order by PJFFT.JOB_FAMILY_NAME

Job
=====
SELECT 
       PJFV.EFFECTIVE_START_DATE
	  ,decode(to_char(PJFV.Effective_End_Date,'DD-MM-YYYY'),'31-12-4712',NULL,PJFV.Effective_End_Date) AS "EFFECTIVE_END_DATE"
	  ,PJFV.JOB_CODE
	  ,PJFV.NAME JOB_TITLE
	  ,PJFFT.JOB_FAMILY_NAME 
	  ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='YES_NO' 
						AND LOOKUP_CODE=PJFV.MED_CHECKUP_REQ 
						and NVL(:REPDATE,SYSDATE) between START_DATE_ACTIVE and END_DATE_ACTIVE and language ='US') MEDICAL_CHECK_UP
	  ,PJFV.MANAGER_LEVEL "LEVEL"
	  -- ,PJFV.MANAGER_LEVEL MANAGEMENT_LEVEL
	  ,(select meaning from fnd_lookup_values where lookup_type = 'MANAGER_LEVEL' 
	                    AND LOOKUP_CODE=PJFV.MANAGER_LEVEL) MANAGEMENT_LEVEL
	  ,( SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='YES_NO' 
						AND LOOKUP_CODE=PJFV.BENCHMARK_JOB_FLAG  
						AND NVL(:REPDATE,SYSDATE) between START_DATE_ACTIVE and END_DATE_ACTIVE and language ='US') BENCHMARK_IN_PROGRESS
	  ,PJLF.INFORMATION1 AS FLSA
	  -- ,PJLF.INFORMATION2 AS "EEO_CATEGORY"
	  ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='HRX_US_EEO1_JOB_CATEGORY' 
						AND LOOKUP_CODE=PJLF.INFORMATION2
						AND NVL(:REPDATE,SYSDATE) between START_DATE_ACTIVE and END_DATE_ACTIVE and language ='US') AS "EEO_CATEGORY"
	  ,PG.GRADE_CODE
      ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='ACTIVE_INACTIVE' 
						AND LOOKUP_CODE=PJFV.ACTIVE_STATUS
						AND NVL(:REPDATE,SYSDATE) between START_DATE_ACTIVE and END_DATE_ACTIVE and language ='US') AS STATUS
	  ,NULL WORKERS_COMP_CODE
	  ,PJFV.ATTRIBUTE4 AS JOB_LABOUR_TYPE
	  ,PJFV.ATTRIBUTE1 AS TOI
	  ,PJFV.ATTRIBUTE2 "RSU_Target_By_Grade"
	  ,PJFV.ATTRIBUTE3 "RSU_Participation_Rate"
FROM
       PER_JOBS_F_VL PJFV
      ,PER_JOB_LEG_F PJLF
	  ,PER_VALID_GRADES_F PVG
	  ,PER_GRADES PG
	  ,PER_JOB_FAMILY_F_TL PJFFT
WHERE 1=1
AND   PJFV.JOB_ID=PJLF.JOB_ID(+)
AND   PJLF.LEGISLATION_CODE (+) ='US'
AND   PJFV.JOB_FAMILY_ID=PJFFT.JOB_FAMILY_ID(+)
AND   PJFV.JOB_ID=PVG.JOB_ID(+)
AND   PVG.GRADE_ID=PG.GRADE_ID(+)
AND   PJFFT.LANGUAGE(+) = 'US'
-- AND PJFV.ACTIVE_STATUS='A'
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PJFV.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PJFV.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PJLF.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PJLF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PVG.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PVG.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PG.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PG.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PJFFT.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PJFFT.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
--and pjfv.job_code = '10'
ORDER BY PJFV.NAME


Legal Entity
====================
select HLE.NAME LEGAL_ENTITY_NAME
,HLE.ORGANIZATION_CODE
,TO_CHAR(HLE.EFFECTIVE_START_DATE,'MM/DD/YYYY')  START_DATE
,XR.REGISTRATION_NUMBER
,INITCAP(FT.NLS_TERRITORY) COUNTRY
,LOC.COUNTRY COUNTRY_CODE
,FT.CURRENCY_CODE CURRENCY
,LOC.REGION_2 STATEE
,LOC.REGION_1 COUNTY
,LOC.TOWN_OR_CITY CITY
,LOC.ADDRESS_LINE_1	ADDRESS_LINE1
,LOC.ADDRESS_LINE_2 ADDRESS_LINE2
,LOC.ADDRESS_LINE_3 ADDRESS_LINE3
,LOC.ADDRESS_LINE_4 ADDRESS_LINE4
,LOC.TOWN_OR_CITY CITY_OR_TOWN
,LOC.POSTAL_CODE 
,XR.REGISTERED_NAME
	  
from HR_LEGAL_ENTITIES HLE
    ,XLE_REGISTRATIONS XR
	,XLE_LOCATIONS_V LOC
	,FND_TERRITORIES FT
where 1=1
AND HLE.CLASSIFICATION_CODE (+)= 'HCM_LEMP'
AND HLE.STATUS = 'A'
AND HLE.NAME = XR.REGISTERED_NAME(+)
AND XR.SOURCE_TABLE = 'XLE_ENTITY_PROFILES'
AND XR.LOCATION_ID = LOC.LOCATION_ID
AND LOC.COUNTRY = FT.TERRITORY_CODE
AND FT.ENABLED_FLAG = 'Y'

LOCATION
======================
SELECT LOC.EFFECTIVE_START_DATE
       ,LOC.EFFECTIVE_END_DATE
       ,LOC.COUNTRY
       ,LOC.INTERNAL_LOCATION_CODE AS "LOCATION_CODE"
       ,LOC.LOCATION_NAME
       ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='ACTIVE_INACTIVE' AND LOOKUP_CODE=LOC.ACTIVE_STATUS) ACTIVE_STATUS
       ,LOC.ADDRESS_LINE_1
       ,LOC.ADDRESS_LINE_2
       ,LOC.ADDRESS_LINE_3
       ,LOC.ADDRESS_LINE_4
       ,LOC.TOWN_OR_CITY CITY
       ,LOC.REGION_2 STATE
       ,LOC.POSTAL_CODE
       ,LOC.REGION_3 PROVIENCE
       ,LOC.REGION_1 COUNTY
       ,LOC.TELEPHONE_NUMBER_1 PHONE
       ,LOC.FAX_SUBSCRIBER_NUM2 FAX
       ,LOC.EMAIL_ADDRESS EMAIL
       ,LOC.TIMEZONE_CODE
  ,LOC.ATTRIBUTE1 AS "TOWNSHIP"
       ,LOC.ATTRIBUTE2 AS "REGION"
	   ,LOC.ATTRIBUTE3 AS "FRINGE_RATE"
FROM HR_LOCATIONS LOC

/
Payroll
=============
SELECT  PLDG.NAME AS LEGISLATIVE_DATA_GROUP
		,PAPF.PAYROLL_NAME AS PAYROLL_NAME 
		,PAPF.PERIOD_TYPE AS PERIOD_TYPE
		,PAPF.NUMBER_OF_YEARS AS NUMBER_OF_YEARS
		,PAPF.FIRST_PERIOD_END_DATE AS FIRST_PERIOD_END_DATE
		,PAPF.REPORTING_NAME AS REPORTING_NAME
		,PAPF.EFFECTIVE_START_DATE AS EFFECTIVE_START_DATE
		,PAPF.EFFECTIVE_END_DATE AS EFFECTIVE_END_DATE
--,DECODE(TO_CHAR(PAPF.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,PAPF.EFFECTIVE_END_DATE) AS EFFECTIVE_END_DATE	
		,PCS.CONSOLIDATION_SET_NAME AS CONSOLIDATION_NAME 
FROM PAY_ALL_PAYROLLS_F PAPF
	 ,PAY_CONSOLIDATION_SETS PCS
	 ,PER_LEGISLATIVE_DATA_GROUPS_VL PLDG
WHERE 1=1
AND PAPF.CONSOLIDATION_SET_ID = PCS.CONSOLIDATION_SET_ID
AND PLDG.LEGISLATIVE_DATA_GROUP_ID =PCS.LEGISLATIVE_DATA_GROUP_ID
--AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PAPF.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PAPF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
order by PLDG.NAME

/

Person ADDRESS
==============
SELECT PAPF.PERSON_NUMBER
      ,PPAU.EFFECTIVE_START_DATE
      ,decode(to_char(PPAU.EFFECTIVE_END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,PPAU.EFFECTIVE_END_DATE)  AS EFFECTIVE_END_DATE
      ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='ADDRESS_TYPE' AND LOOKUP_CODE=PPAU.ADDRESS_TYPE and language='US') AS ADDRESS_TYPE
      ,ADDRESS.ADDRESS_LINE_1  ADDRESS_LINE_1
		   ,ADDRESS.ADDRESS_LINE_2  ADDRESS_LINE_2
		   ,ADDRESS.ADDRESS_LINE_3  ADDRESS_LINE_3
		   ,ADDRESS.ADDRESS_LINE_4  ADDRESS_LINE_4
		   ,ADDRESS.TOWN_OR_CITY CITY
       ,ADDRESS.REGION_2 STATE
		   ,ADDRESS.POSTAL_CODE POSTAL_CODE
       ,ADDRESS.REGION_3  PROVIENCE
		   ,ADDRESS.REGION_1 COUNTY
       ,HOME_COUNTRY.TERRITORY_SHORT_NAME COUNTRY
	   ,(SELECT ADDR.ADDRESS_LINE_1
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALADD1
		 
		 ,(SELECT ADDR.ADDRESS_LINE_2
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALADD2
		 
		 ,(SELECT ADDR.ADDRESS_LINE_3
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALADD3
		 
		 ,(SELECT ADDR.TOWN_OR_CITY
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALCITY
		 
		  ,(SELECT ADDR.REGION_2
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALSTATE
		 
		 ,(SELECT ADDR.POSTAL_CODE
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALPOSTALCODE
		 
		 ,(SELECT ADDR.COUNTRY
	     FROM PER_PERSON_ADDR_USAGES_F PPAU1
		     ,PER_ADDRESSES_F ADDR
         WHERE 1=1
         AND PPAU1.PERSON_ID = PAPF.PERSON_ID
         AND PPAU1.ADDRESS_TYPE = 'LOCAL_LANGUAGE_ADDRESS'
		 AND PPAU1.ADDRESS_ID = ADDR.ADDRESS_ID
		 AND SYSDATE BETWEEN PPAU1.EFFECTIVE_START_DATE AND PPAU1.EFFECTIVE_END_DATE
         AND SYSDATE BETWEEN ADDR.EFFECTIVE_START_DATE AND ADDR.EFFECTIVE_END_DATE) LOCALCOUNTRY		   
FROM PER_ALL_PEOPLE_F PAPF
    ,PER_PERSON_ADDR_USAGES_F PPAU
    ,PER_ADDRESSES_F ADDRESS
    ,FND_TERRITORIES_VL HOME_COUNTRY
WHERE 1=1
--and SUBSTR(PAPF.PERSON_NUMBER,1,1) = 'A'
AND PAPF.MAILING_ADDRESS_ID = ADDRESS.ADDRESS_ID
AND ADDRESS.ADDRESS_ID = PPAU.ADDRESS_ID
AND ADDRESS.COUNTRY = HOME_COUNTRY.TERRITORY_CODE (+)
AND HOME_COUNTRY.ENABLED_FLAG(+) = 'Y'
AND SYSDATE BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
AND SYSDATE BETWEEN PPAU.EFFECTIVE_START_DATE(+) AND PPAU.EFFECTIVE_END_DATE(+)
AND SYSDATE BETWEEN ADDRESS.EFFECTIVE_START_DATE(+) AND ADDRESS.EFFECTIVE_END_DATE(+)
ORDER BY 1

Person Assignment
=====================
SELECT	DISTINCT PAPF.PERSON_NUMBER AS EMPLOYEE_NUMBR
      ,SUBSTR(PAPF.PERSON_NUMBER,2) AS LEG_EMPLOYEE_NUMBR
       ,PAAM.ASSIGNMENT_SEQUENCE AS WORK_RELATIONSHIP_NUMBER
	   ,paam.assignment_name
	   ,'1' ASSIGNMENT_REFERENCE_NUMBER
	   ,DECODE(PAAM.PRIMARY_FLAG,'Y','Yes','N','No','No') AS PRIMARY_ASSIGNMENT
	   ,PAAM.EFFECTIVE_START_DATE
	   ,decode(to_char(PAAM.Effective_End_Date,'DD-MM-YYYY'),'31-12-4712',NULL,PAAM.Effective_End_Date) AS "EFFECTIVE_END_DATE"
	   ,PA.ACTION_NAME AS ACTION
	   ,PAR.ACTION_REASON
	   ,HAOU.Name as LEGAL_EMPLOYER
	   ,(SELECT MIN(A.DATE_START) FROM PER_PERIODS_OF_SERVICE A WHERE A.PERSON_ID = PAPF.PERSON_ID) AS ENTERPRISE_START_DATE
	   ,PPOS.ORIGINAL_DATE_OF_HIRE AS ENTERPRISE_SENIORITY_DATE
	   ,PPOS.DATE_START AS LEGAL_EMPLOYER_START_DATE
	   ,PPOS.ADJUSTED_SVC_DATE AS LEMP_SENIORITY_DATE
	   ,HAOU1.Name as BUSINESS_UNIT
	   ,pjb.job_code as JOB
	   ,PG.NAME AS GRADE
	   ,(SELECT POSITION_CODE FROM PER_POSITION_SECURED_LIST_V WHERE POSITION_ID=PAAM.POSITION_ID) As POSITION
	   ,PD.NAME as Department
	   ,HLAF.LOCATION_NAME as LOCATION_CODE
	   ,HLAF.INTERNAL_LOCATION_CODE as LOCATION
	   ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='HRC_YES_NO' AND LOOKUP_CODE=PAAM.WORK_AT_HOME AND LANGUAGE = 'US') as WORK_AT_HOME
	   ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='ACA_COMMON_YES_NO_CHAR' AND LOOKUP_CODE=PAAM.MANAGER_FLAG AND LANGUAGE = 'US') as WORKING_AS_MANAGER
	   ,PAAM.NORMAL_HOURS as WORKING_HOURS
	   ,(SELECT FLV.MEANING FROM FND_LOOKUP_VALUES FLV WHERE LOOKUP_TYPE='FREQUENCY' AND FLV.LOOKUP_CODE=PAAM.FREQUENCY AND LANGUAGE = 'US') AS FREQUENCY
	   --,(select distinct a.person_number from per_all_people_f a where rownum=1 and --a.person_id=pasf.manager_id)MANAGER_EMPLOYEE_NUMBER
	   --,MGR.PERSON_NUMBER AS MANAGER_EMPLOYEE_NUMBER
	   /*,(SELECT MGR.PERSON_NUMBER
	       FROM PER_ALL_PEOPLE_F MGR
		       ,PER_ASSIGNMENT_SUPERVISORS_F PASF
			   ,PER_PERSON_NAMES_F PPNF1
			   ,PER_ALL_ASSIGNMENTS_M PAAM1
		   WHERE 1=1 AND ROWNUM=1
		    AND PASF.PRIMARY_FLAG='Y'
	        AND MGR.PERSON_ID=PASF.MANAGER_ID 
            AND MGR.PERSON_ID = PPNF1.PERSON_ID
			AND PASF.ASSIGNMENT_ID=PAAM1.ASSIGNMENT_ID
			AND PAAM1.ASSIGNMENT_ID=PAAM.ASSIGNMENT_ID
			--AND PAAM1.ASSIGNMENT_ID=300000010113375
			AND PAAM1.ACTION_CODE =PAAM.ACTION_CODE
			AND PAAM1.REASON_CODE =PAAM.REASON_CODE
			AND PPNF1.NAME_TYPE(+)= 'GLOBAL'
			AND PAAM.PRIMARY_FLAG='Y'
			AND NVL(:REPORT_DATE,SYSDATE) BETWEEN MGR.EFFECTIVE_START_DATE(+) AND NVL(MGR.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
		    AND NVL(:REPORT_DATE,SYSDATE) BETWEEN PASF.EFFECTIVE_START_DATE(+) AND NVL(PASF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
			AND NVL(:REPORT_DATE,SYSDATE) BETWEEN PAAM1.EFFECTIVE_START_DATE(+) AND NVL(PAAM1.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
			-- AND PASF.EFFECTIVE_START_DATE BETWEEN PAAM1.EFFECTIVE_START_DATE(+) AND NVL(PAAM1.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
			AND NVL(:REPORT_DATE,SYSDATE) BETWEEN PPNF1.EFFECTIVE_START_DATE(+) AND NVL(PPNF1.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
	    )AS MANAGER_EMPLOYEE_NUMBER*/
		,(SELECT MGR.PERSON_NUMBER
	       FROM PER_ALL_PEOPLE_F MGR
		       ,PER_ASSIGNMENT_SUPERVISORS_F PASF
			   ,PER_PERSON_NAMES_F PPNF1
		   WHERE 1=1 AND ROWNUM=1
		    AND PASF.PRIMARY_FLAG(+)='Y'
	        AND PASF.MANAGER_ID = MGR.PERSON_ID(+)
            AND MGR.PERSON_ID = PPNF1.PERSON_ID(+)
			AND PASF.ASSIGNMENT_ID=PAAM.ASSIGNMENT_ID
			AND PPNF1.NAME_TYPE(+)= 'GLOBAL'
            AND PAAM.EFFECTIVE_START_DATE BETWEEN PASF.EFFECTIVE_START_DATE AND PASF.EFFECTIVE_END_DATE) AS MANAGER_EMPLOYEE_NUMBER
	   ,PAST.USER_STATUS as Assignment_Status
	   ,HL.MEANING as Worker_Type
	   ,PER_TYPES.USER_PERSON_TYPE PERSON_TYPE
	   ,(select meaning from hr_lookups where lookup_type='EMP_CAT' AND lookup_code=PAAM.EMPLOYMENT_CATEGORY) AS ASSIGNMENT_CATEGORY
	   ,PAWM.VALUE FTE
	   ,'1' HEAD_COUNT
	   ,PAAM.DEFAULT_CODE_COMB_ID AS DEFAULT_ACCOUNT
	   ,PPOS.ACTUAL_TERMINATION_DATE AS TERMINATION_DATE
	   ,PPOS.NOTIFIED_TERMINATION_DATE NOTIFICATION_DATE
	   ,CASE WHEN PPOS.ACTUAL_TERMINATION_DATE IS NOT NULL THEN PA.ACTION_NAME ELSE '' END TERMINATION_ACTION
	   ,CASE WHEN PPOS.ACTUAL_TERMINATION_DATE IS NOT NULL THEN PAR.ACTION_REASON ELSE '' END TERMINATION_REASON
       ,PAAM.LEGISLATION_CODE as Country
	   ,PAAM.ASS_ATTRIBUTE5 EXPORT_CONTROL_COMPLIANCE 
       ,PAAM.ASS_ATTRIBUTE4 EXPAT_HOME_LOCATION
	   ,PAAM.ASS_ATTRIBUTE2 EXPAT_EQUITY_TRACKING
	   ,PAAM.ASS_ATTRIBUTE1 PRIOR_EMPLOYMENT_AUDITOR
	   ,TO_CHAR(PAAM.ASS_ATTRIBUTE_DATE1, 'MM/DD/YYYY') ACQUISITION_DATE
	   ,PAAM.ASS_ATTRIBUTE3 ACQUIRED_COMPANY
	   ,TO_CHAR(PAAM.ASS_ATTRIBUTE_DATE2, 'MM/DD/YYYY') FIRST_JOB_DATE
	   ,PAAM.ASS_ATTRIBUTE6 INCENTIVE_PLAN_TYPE
	   ,PPG.SEGMENT1 SHIFT
	   ,PPG.SEGMENT2 NONSTDWS
	   ,PPG.SEGMENT3 PAYROLLCOUNTRY
	   ,PPG.SEGMENT4 PAYROLLLOCATION
FROM	PER_ALL_PEOPLE_F PAPF
       ,PER_PERSON_NAMES_F NAMES
	   ,PER_PERIODS_OF_SERVICE PPOS
	   ,PER_ALL_ASSIGNMENTS_M PAAM
	   ,PER_ASSIGN_WORK_MEASURES_F PAWM
	   ,PER_ACTIONS_VL PA
	   ,PER_ACTION_REASONS_VL PAR
	   ,HR_ALL_ORGANIZATION_UNITS HAOU
	   ,HR_LOCATIONS HLAF
	   ,PER_PERSON_TYPES_VL PER_TYPES
	   ,PER_ASSIGNMENT_STATUS_TYPES_TL PAST
	   ,PER_JOBS PJB
	   ,PER_GRADES PG
	   ,PER_DEPARTMENTS PD
	   ,HR_ALL_ORGANIZATION_UNITS HAOU1
	   ,HR_LOOKUPS HL
	   -- ,PER_ASSIGNMENT_SUPERVIqSORS_F PASF
	   -- ,per_person_names_f ppnf1
	   ,PER_PEOPLE_GROUPS PPG
	   --,PER_ALL_PEOPLE_F MGR
 WHERE 1=1	
--and SUBSTR(PAPF.PERSON_NUMBER,1,1) = 'A'
   AND PAPF.PERSON_ID=PAAM.PERSON_ID(+)
   AND PAAM.ASSIGNMENT_ID = PAWM.ASSIGNMENT_ID(+)
   AND PAWM.UNIT(+) = 'FTE'
   AND PAAM.ACTION_CODE = PA.ACTION_CODE(+)
   AND PAAM.REASON_CODE = PAR.ACTION_REASON_CODE(+)
   AND PAPF.PERSON_ID = NAMES.PERSON_ID(+)
   AND NAMES.NAME_TYPE(+) = 'GLOBAL'
   AND PAPF.PERSON_ID = PPOS.PERSON_ID
   AND PAAM.PERIOD_OF_SERVICE_ID=PPOS.PERIOD_OF_SERVICE_ID(+)
   AND PAAM.LEGAL_ENTITY_ID= haou.organization_id(+)
   AND PAAM.LOCATION_ID=HLAF.LOCATION_ID(+)
   AND PAAM.PERSON_TYPE_ID = PER_TYPES.PERSON_TYPE_ID(+)
   AND PAAM.ASSIGNMENT_STATUS_TYPE_ID=PAST.ASSIGNMENT_STATUS_TYPE_ID(+)
   AND PAST.LANGUAGE='US'
   AND PAAM.JOB_ID=PJB.JOB_ID(+)	
   AND PAAM.GRADE_ID=PG.GRADE_ID(+)
   AND PAAM.ORGANIZATION_ID=PD.ORGANIZATION_ID(+)
   AND PAAM.BUSINESS_UNIT_ID=HAOU1.organization_id(+)
   AND PAAM.PRIMARY_FLAG='Y'
   AND HL.lookup_type='SYSTEM_PERSON_TYPE'
   AND PAAM.SYSTEM_PERSON_TYPE=HL.LOOKUP_CODE(+)
   --AND PAPF.PERSON_NUMBER IN ('10034','54321','54322')
   --and papf.person_id=pasf.person_id(+)
   --and pasf.manager_id=ppnf1.person_id(+)
   -- AND PASF.PRIMARY_FLAG(+)='Y'
   -- AND ppnf1.name_type(+)= 'GLOBAL'
   AND PAAM.PEOPLE_GROUP_ID = PPG.PEOPLE_GROUP_ID(+)
   AND PAAM.ASSIGNMENT_TYPE IN ('E','C')
   --AND PAAM.ASSIGNMENT_ID = PASF.ASSIGNMENT_ID(+)
   -- AND PASF.MANAGER_ID = MGR.PERSON_ID(+)
   -- AND MGR.PERSON_ID = ppnf1.PERSON_ID(+)
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAPF.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,PAPF.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,NAMES.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,NAMES.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAAM.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PAAM.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAWM.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PAWM.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,HAOU.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,HAOU.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,HLAF.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,HLAF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PJB.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PJB.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PG.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PG.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PD.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PD.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,HAOU1.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,HAOU1.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PA.START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PA.END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAR.START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PAR.END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   -- AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PPNF1.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PPNF1.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   -- AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PASF.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PASF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
   -- AND NVL(:REPORT_DATE,SYSDATE) BETWEEN MGR.EFFECTIVE_START_DATE(+) AND NVL(MGR.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
--AND PAPF.PERSON_NUMBER='200004'
ORDER BY PAPF.PERSON_NUMBER

Person Contact
===============
SELECT PAPF.PERSON_NUMBER
      ,CPAPF.PERSON_NUMBER CON_NO
	  ,CNAME.LAST_NAME
		,CNAME.FIRST_NAME
		,CNAME.MIDDLE_NAMES
        ,CNAME.SUFFIX
		,CNAME.KNOWN_AS AS PREFERED_NAME
		,CNAME.PREVIOUS_LAST_NAME
		,(SELECT HL.MEANING FROM HR_LOOKUPS HL WHERE HL.LOOKUP_TYPE = 'CONTACT' AND PCR.CONTACT_TYPE = HL.LOOKUP_CODE)  AS  CONTACT_TYPE
		,TO_CHAR(PCR.EFFECTIVE_START_DATE,'MM/DD/YYYY') EFFECTIVE_START_DATE
		,PCR.EMERGENCY_CONTACT_FLAG
		,(SELECT FLV.MEANING FROM FND_LOOKUP_VALUES FLV WHERE FLV.LOOKUP_TYPE ='SEX' AND FLV.LOOKUP_CODE=LEG_INFO.SEX) GENDER
		,(SELECT FLV.MEANING FROM FND_LOOKUP_VALUES FLV WHERE FLV.LOOKUP_TYPE ='MAR_STATUS' AND FLV.LOOKUP_CODE=LEG_INFO.MARITAL_STATUS) MARITAL_STATUS
		,PERSON.DATE_OF_BIRTH
		,NID.LEGISLATION_CODE NCOUNTRY
		,NID.NATIONAL_IDENTIFIER_TYPE
		,NID.NATIONAL_IDENTIFIER_NUMBER
		,ADDR.ADDRESS_LINE_1
		,ADDR.ADDRESS_LINE_2
		,ADDR.ADDRESS_LINE_3
		,ADDR.TOWN_OR_CITY AS CITY
		,ADDR.REGION_1 AS COUNTY
		,ADDR.REGION_2 AS STATE
		,ADDR.COUNTRY
		,ADDR.POSTAL_CODE
		,PHONE.PHONE_TYPE
		,PHONE.PHONE_NUMBER
		,PHONE.AREA_CODE
		,PHONE.COUNTRY_CODE_NUMBER
		,PHONE.EXTENSION
		,PCR.DEPENDENT_FLAG DEP_FLAG
,PCR.CONTACT_PERSON_ID
FROM PER_CONTACT_RELATIONSHIPS PCR
     ,PER_ALL_PEOPLE_F PAPF
	 ,PER_ALL_PEOPLE_F CPAPF
	 ,PER_PERSON_NAMES_F CNAME
	 ,PER_PEOPLE_LEGISLATIVE_F LEG_INFO
	 ,PER_PERSONS PERSON
	 ,PER_NATIONAL_IDENTIFIERS NID
	 ,PER_ADDRESSES_F ADDR
	 ,PER_PHONES PHONE
WHERE 1=1
--AND SUBSTR(PAPF.PERSON_NUMBER,1,1) = 'A'
--AND  papf.person_number  in ( '59388')
AND PCR.PERSON_ID = PAPF.PERSON_ID
AND PCR.CONTACT_PERSON_ID = CPAPF.PERSON_ID
AND CPAPF.PERSON_ID = CNAME.PERSON_ID
AND CNAME.NAME_TYPE = 'GLOBAL'
AND CPAPF.PERSON_ID = LEG_INFO.PERSON_ID(+)
AND CPAPF.PERSON_ID = PERSON.PERSON_ID(+)
AND CPAPF.PRIMARY_NID_ID = NID.NATIONAL_IDENTIFIER_ID(+)
AND CPAPF.MAILING_ADDRESS_ID = ADDR.ADDRESS_ID(+)
AND CPAPF.PRIMARY_PHONE_ID = PHONE.PHONE_ID(+)
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAPF.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,PAPF.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,CPAPF.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,CPAPF.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,CNAME.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,CNAME.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,LEG_INFO.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,LEG_INFO.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,ADDR.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,ADDR.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PHONE.DATE_FROM(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PHONE.DATE_TO(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
ORDER BY PAPF.PERSON_NUMBER

Person Earning Elements
==========================
select distinct papf.person_number,PAAM.ASSIGNMENT_NUMBER
      ,ELE.ELEMENT_TYPE_ID
   ,to_char(ele.EFFECTIVE_START_DATE,'MM/DD/YYYY') EFFECTIVE_START_DATE
   ,TO_CHAR(ele.EFFECTIVE_END_DATE,'MM/DD/YYYY') EFFECTIVE_END_DATE
   ,ele_type.base_element_name
  --,IV.BASE_NAME
  -- ,val.SCREEN_ENTRY_VALUE BASEMIX 
,(SELECT name FROM PER_LEGISLATIVE_DATA_GROUPS_VL
     WHERE paam.LEGISLATION_CODE = LEGISLATION_CODE) LDG
--,paam.ASSIGNMENT_STATUS_TYPE
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name = 'Amount'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) Amount
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name like 'Base Mix%'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) base
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name like 'Commission Mix%'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) commission
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name like 'Percentage%'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) percent
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name like 'Bonus Target AIP%'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) Bonus_AIP		
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name like 'Bonus Target MIP%'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) Bonus_MIP	
,(select val.SCREEN_ENTRY_VALUE
		 from PAY_ELEMENT_ENTRY_VALUES_F VAL,PAY_INPUT_VALUES_F IV
		where ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID
		AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
		AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID
		 and iv.base_name like 'Target'
		 and val.SCREEN_ENTRY_VALUE is not null
		 AND ele.effective_start_date between iv.EFFECTIVE_START_DATE AND iv.EFFECTIVE_END_DATE
		 AND ele.effective_start_date between val.EFFECTIVE_START_DATE AND val.EFFECTIVE_END_DATE ) Target_Commission			 

		 
from 
	 per_all_people_f papf
    ,per_all_assignments_m paam
	,PER_PERIODS_OF_SERVICE PPOS
	,PAY_ELEMENT_ENTRIES_F ELE
    ,PAY_ELEMENT_TYPES_F ELE_TYPE
    --,PAY_INPUT_VALUES_F IV
   -- ,PAY_ELEMENT_ENTRY_VALUES_F VAL
where 1=1
AND ELE.PERSON_ID = PAPF.PERSON_ID
and ELE.ELEMENT_TYPE_ID = ELE_TYPE.ELEMENT_TYPE_ID
-- AND ELE_TYPE.ELEMENT_TYPE_ID=IV.ELEMENT_TYPE_ID(+)
-- AND ELE.ELEMENT_ENTRY_ID = VAL.ELEMENT_ENTRY_ID(+)
 --AND IV.INPUT_VALUE_ID = VAL.INPUT_VALUE_ID
 --and IV.BASE_NAME like 'Base%Mix%'
 AND (ele_type.BASE_ELEMENT_NAME like 'Commission%'
 or ele_type.BASE_ELEMENT_NAME like 'Company Car Allowance%'
 or ele_type.BASE_ELEMENT_NAME like 'Bonus%')
 --and val.SCREEN_ENTRY_VALUE is not null
-- and :REPDATE between ele.EFFECTIVE_START_DATE and ele.EFFECTIVE_END_DATE
-- AND :REPDATE between val.effective_start_date and val.effective_end_date
and ELE.EFFECTIVE_START_DATE BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
AND paam.person_id = papf.person_id
AND paam.primary_flag = 'Y'
--AND paam.ASSIGNMENT_STATUS_TYPE = 'ACTIVE'
AND paam.assignment_type IN ('E','C','N')
AND PAAM.PERIOD_OF_SERVICE_ID=PPOS.PERIOD_OF_SERVICE_ID
AND ELE.EFFECTIVE_START_DATE BETWEEN PPOS.DATE_START AND NVL(PPOS.ACTUAL_TERMINATION_DATE,TO_DATE('12/31/4712','MM/DD/YYYY'))
and ELE.EFFECTIVE_START_DATE BETWEEN PAAM.EFFECTIVE_START_DATE AND PAAM.EFFECTIVE_END_DATE
order by papf.person_number

Person EMAIL
===========
SELECT PAPF.PERSON_NUMBER AS EMPLOYEE_NUMBER
      ,DECODE(EMAIL.EMAIL_TYPE,'W1','Work Email','H1','Home Email') AS EMAIL_TYPE
      ,(CASE WHEN PAPF.PRIMARY_EMAIL_ID = EMAIL.EMAIL_ADDRESS_ID THEN 'Y' ELSE '' END) PRIMARY_EMAIL	  
	  ,EMAIL.EMAIL_ADDRESS AS "EMAIL"
	  ,EMAIL.DATE_FROM
	  ,DECODE(TO_CHAR(EMAIL.DATE_TO, 'DD-MON-YYYY'),'31-12-4712',NULL,EMAIL.DATE_TO) AS EFFECTIVE_END_DATE
	 
  FROM PER_ALL_PEOPLE_F PAPF,
	   PER_EMAIL_ADDRESSES EMAIL,
	   PER_CONTACT_RELSHIPS_F PCR
 WHERE 1 = 1
      AND PAPF.PERSON_ID = EMAIL.PERSON_ID
   --AND EMAIL.EMAIL_TYPE IN  ('W1','H1')
   AND Papf.PERSON_ID=PCR.CONTACT_PERSON_ID(+)
   AND PCR.CONTACT_TYPE IS NULL
   AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAPF.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,PAPF.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))
   
   
   Person NID
   ==========
   SELECT PAPF.PERSON_NUMBER
      ,PERSON.DATE_OF_BIRTH
      ,PERSON.COUNTRY_OF_BIRTH
      ,PERSON.REGION_OF_BIRTH
      ,PERSON.TOWN_OF_BIRTH
      ,FLV.MEANING  NATIONAL_IDENTIFIER_TYPE
		   ,PNI.NATIONAL_IDENTIFIER_NUMBER  NATIONAL_IDENTIFIER
		   ,PNI.LEGISLATION_CODE COUNTRY_OF_NATIONAL_IDENTIFIER
       ,PNI.ISSUE_DATE
       ,PNI.EXPIRATION_DATE
       ,PNI.CREATION_DATE
       ,(CASE WHEN PAPF.PRIMARY_NID_ID = PNI.NATIONAL_IDENTIFIER_ID THEN 'Y' ELSE '' END) PRIMARY
FROM PER_ALL_PEOPLE_F PAPF
 ,PER_PERSONS PERSON
 ,PER_NATIONAL_IDENTIFIERS PNI
 ,FND_LOOKUP_VALUES FLV
WHERE 1=1
AND PAPF.PERSON_ID = PERSON.PERSON_ID(+)
 AND PAPF.PERSON_ID=PNI.PERSON_ID(+)
 AND PNI.NATIONAL_IDENTIFIER_TYPE =  FLV.LOOKUP_CODE(+)
AND LOOKUP_TYPE(+) = 'PER_NATIONAL_IDENTIFIER_TYPE'
and flv.language(+) = 'US'
 -- and papf.person_number = '969696'
AND SYSDATE BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
AND PAPF.PERSON_ID IN (SELECT PERSON_ID FROM PER_ALL_ASSIGNMENTS_M)

Person PAYROLL
=================
SELECT PAPF.PERSON_NUMBER
       ,PAYROLLS.PAYROLL_NAME
	   ,TO_CHAR(PAPD.START_DATE,'MM/DD/YYYY')  EFFECTIVE_START_DATE
	   ,decode(to_char(PAPD.END_DATE,'DD-MM-YYYY'),'31-12-4712',NULL,TO_CHAR(PAPD.END_DATE,'MM/DD/YYYY')) AS "EFFECTIVE_END_DATE"
	   ,HAOU.Name as LEGAL_EMPLOYER
FROM PER_ALL_PEOPLE_F PAPF
    ,PAY_PAY_RELATIONSHIPS_DN PPRF
	,PAY_REL_GROUPS_DN PRGD
	,PAY_ASSIGNED_PAYROLLS_DN PAPD
	 ,PAY_ALL_PAYROLLS_F PAYROLLS
	 ,PER_ALL_ASSIGNMENTS_M PAAM
	 ,HR_ALL_ORGANIZATION_UNITS HAOU
WHERE 1=1
AND PAPF.PERSON_ID = PPRF.PERSON_ID
 AND PPRF.PAYROLL_RELATIONSHIP_ID = PRGD.PAYROLL_RELATIONSHIP_ID
   AND PRGD.GROUP_TYPE = 'T'
   AND PRGD.RELATIONSHIP_GROUP_ID = PAPD.PAYROLL_TERM_ID
   AND PAPD.PAYROLL_ID = PAYROLLS.PAYROLL_ID
   AND PAPF.PERSON_ID=PAAM.PERSON_ID
   AND PAAM.LEGAL_ENTITY_ID= haou.organization_id(+)
AND 	NVL(:REPDATE,SYSDATE) BETWEEN PAPF.EFFECTIVE_START_DATE(+) AND NVL(PAPF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND 	NVL(:REPDATE,SYSDATE) BETWEEN PPRF.START_DATE(+) AND NVL(PPRF.END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND 	NVL(:REPDATE,SYSDATE) BETWEEN PRGD.START_DATE(+) AND NVL(PRGD.END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
 --AND 	NVL(:REPDATE,SYSDATE) BETWEEN PAPD.START_DATE(+) AND NVL(PAPD.END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
 AND 	NVL(:REPDATE,SYSDATE) BETWEEN PAYROLLS.EFFECTIVE_START_DATE(+) AND NVL(PAYROLLS.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
 AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,PAAM.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,PAAM.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
 AND NVL(:REPDATE,SYSDATE) BETWEEN NVL2(:REPDATE,HAOU.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPDATE,HAOU.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
--and SUBSTR(PAPF.PERSON_NUMBER,1,1) = 'A'
--AND PAPF.PERSON_NUMBER='10079'
and 1=1
group by PAPF.PERSON_NUMBER
       ,PAYROLLS.PAYROLL_NAME
	   ,PAPD.START_DATE
	   ,PAPD.END_DATE
	   ,HAOU.Name
order by papf.person_number

Person Phones
===============
SELECT PAPF.PERSON_NUMBER
       ,(SELECT MEANING FROM FND_LOOKUP_VALUES WHERE LOOKUP_TYPE='PHONE_TYPE' AND LOOKUP_CODE=PHONES.PHONE_TYPE AND LANGUAGE = 'US') AS PHONE_TYPE
       ,PAPF.PRIMARY_PHONE_ID
       ,PHONES.DATE_FROM
       ,decode(to_char(PHONES.DATE_TO,'DD-MM-YYYY'),'31-12-4712',NULL,PHONES.DATE_TO) AS DATE_TO
       ,PHONES.PHONE_NUMBER
       ,PHONES.PHONE_ID
       ,(CASE WHEN PAPF.PRIMARY_PHONE_ID = PHONES.PHONE_ID THEN 'Yes' ELSE '' END) PRIMARY
       ,PHONES.COUNTRY_CODE_NUMBER
       ,PHONES.AREA_CODE
       ,PHONES.EXTENSION
FROM PER_ALL_PEOPLE_F PAPF
 ,PER_PHONES PHONES
WHERE 1=1
--AND SUBSTR(PAPF.PERSON_NUMBER,1,1) = 'A'
AND PAPF.PERSON_ID = PHONES.PERSON_ID
AND SYSDATE BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
AND SYSDATE BETWEEN PHONES.DATE_FROM AND NVL(PHONES.DATE_TO,TO_DATE('12-31-4712','MM-dd-yyyy'))
AND PAPF.PERSON_ID IN (SELECT PERSON_ID FROM PER_ALL_ASSIGNMENTS_M)
ORDER BY  1

Person SALARY
=================
SELECT distinct papf.person_number
       ,to_char(cs.date_from,'MM/DD/YYYY') DATE_FROM
	   ,TO_CHAR(cs.date_to,'MM/DD/YYYY') DATE_TO
	   ,cs.salary_amount
	   ,pat.action_name
	   ,parl.Action_Reason
	   ,csv.local_currency
	   ,(SELECT csbtl.salary_basis_name FROM  CMP_SALARY_BASES_TL csbtl 
       WHERE  csbtl.salary_basis_id = csbt.salary_basis_id  
       AND    csbtl.language  = 'US'  ) AS  name
	   ,(select count(person_id) from per_periods_of_service ppos where ppos.person_id = papf.person_id) WORKREL
     ,csv.salary_id
     ,csbt.salary_basis_id
from per_all_people_f papf
    ,per_all_assignments_m paam
	,cmp_salary cs
	,per_actions_tl pat
	,per_action_reasons_vl parl
	,cmp_salary_v csv
	,cmp_salary_bases csbt
where 1=1
--AND SUBSTR(PAPF.PERSON_NUMBER,1,1) = 'A'
--AND PAPF.PERSON_NUMBER  = 'A46759'
and papf.person_id=paam.person_id
and  paam.assignment_type in ('E','C')
and paam.assignment_id = cs.assignment_id
AND  cs.action_id=pat.action_id
and  cs.action_reason_id=parl.action_reason_id(+)
AND  pat.LANGUAGE ='US'
and  cs.salary_id=csv.salary_id
AND  csv.salary_basis_id=csbt.salary_basis_id
AND  NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,papf.effective_start_date,SYSDATE-1) AND NVL2(:REPORT_DATE,papf.effective_end_date,TO_DATE('31-12-4712','DD-MM-YYYY'))
AND  NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,paam.effective_start_date(+),SYSDATE-1) AND NVL2(:REPORT_DATE,paam.effective_end_date(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND  NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,CS.DATE_FROM(+),SYSDATE-1) AND NVL2(:REPORT_DATE,CS.DATE_TO(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
AND  NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,csv.DATE_FROM(+),SYSDATE-1) AND NVL2(:REPORT_DATE,csv.DATE_TO(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
order by papf.person_number

Person Validation
=============
select VISA.LEGISLATION_CODE
      ,VISA.VISA_PERMIT_TYPE
	  ,VISA.VISA_PERMIT_NUMBER
	  ,VISA.ISSUE_DATE
	  ,VISA.EXPIRATION_DATE
	  ,PAPF.PERSON_NUMBER
	  ,PPNF.FULL_NAME
from PER_VISAS_PERMITS_F VISA
     ,PER_ALL_PEOPLE_F PAPF
	 ,PER_PERSON_NAMES_F PPNF
WHERE 1=1
AND VISA.PERSON_ID = PAPF.PERSON_ID
AND PAPF.PERSON_ID = PPNF.PERSON_ID
AND PPNF.NAME_TYPE = 'GLOBAL'
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PAPF.EFFECTIVE_START_DATE,SYSDATE-1) AND NVL2(:REPORT_DATE,PAPF.EFFECTIVE_END_DATE,TO_DATE('31-12-4712','DD-MM-YYYY'))	 
AND NVL(:REPORT_DATE,SYSDATE) BETWEEN NVL2(:REPORT_DATE,PPNF.EFFECTIVE_START_DATE(+),SYSDATE-1) AND NVL2(:REPORT_DATE,PPNF.EFFECTIVE_END_DATE(+),TO_DATE('31-12-4712','DD-MM-YYYY'))
ORDER BY PAPF.PERSON_NUMBER


Extensive Flex Fields
=====================
select papf.person_number 
       ,ppnf.last_name
	   ,ppnf.first_name	   
	   ,ppei.PEI_INFORMATION_CATEGORY
	   ,ppei.pei_information1
	   ,ppei.pei_information2 
	   ,ppei.pei_information3
	   ,ppei.pei_information4 
	   ,ppei.pei_information5 
	   ,ppei.pei_information6 
	   ,ppei.pei_information_date1
	   ,ppei.pei_information_date2
       ,ppei.pei_information_date3
       ,ppei.pei_information_date4
       ,ppei.pei_information_date5
FROM per_people_extra_info_f ppei ,
      per_all_people_f papf ,
      per_person_names_f ppnf
where 1=1
and sysdate between papf.effective_start_date and papf.effective_end_Date
and sysdate between ppnf.effective_start_Date and ppnf.effective_end_Date
and papf.person_id=ppnf.person_id
and ppei.person_id=papf.person_id
--and papf.person_number='0000052'
and ppnf.name_type='GLOBAL'